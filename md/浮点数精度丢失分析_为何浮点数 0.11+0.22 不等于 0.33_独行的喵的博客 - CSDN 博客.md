> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [blog.csdn.net](https://blog.csdn.net/weixin_45863060/article/details/127253232)

#### 文章目录

*   [浮点数精度丢失分析](#_1)
*   *   [案例 1（西电 19 真题）](#119_4)

浮点数精度丢失分析
---------

不了解[浮点数运算](https://so.csdn.net/so/search?q=%E6%B5%AE%E7%82%B9%E6%95%B0%E8%BF%90%E7%AE%97&spm=1001.2101.3001.7020)及 IEEE754 浮点数标准的同学可以参考博文：[浮点数详解](https://blog.csdn.net/weixin_45863060/article/details/125054244?spm=1001.2014.3001.5501)

### 案例 1（[西电](https://so.csdn.net/so/search?q=%E8%A5%BF%E7%94%B5&spm=1001.2101.3001.7020) 19 真题）

```
# include <stdio.h>
main()
{
	int i=123456789;
	float f=123456789.0f;
	f+=20;
	printf("1: %f\n",f);
	f=(float)i;
	printf("2: %f\n",f);
	
	float f1=0.33f,f2=0.11f;
	f2 += 0.22f;
	if(f1==f2)
	{
		printf("3:Equal\n");
	}
	else printf("3:Not Equal\n");
 } 

```

**运行结果：**

```
1: 123456816.000000
2: 123456792.000000
3:Not Equal

```

**问题 1：解释为何浮点数 123456789.0 与 20 相加的结果为 123456816**  
问题解析：  
![](https://img-blog.csdnimg.cn/e542aa4950e34bca867ae5ed0a8e83e8.png)

*   float 变量采用 IEEE754 单精度浮点数的存储格式
*   即尾数省略整数部分默认的 1，而后使用 23 位来表示尾数的小数部分
*   上述格式所能表示的尾数绝对值最大精度为： 2 − 23 2^{-23} 2−23
*   题目中整数 123456789 的二进制形式为：111010110111100110100010101（27 位)
*   按照 IEEE754 标准规格化处理后尾数的结果为 1.11010110111100110100010101（就近舍入法）, 阶码真值为 2 26 2^{26} 226
*   由于 IEEE754 尾数小数部分长度最大 23 位，且舍入处理采用 0 舍 1 入法，故舍入处理后尾数部分为：11010110111100110100011
*   20 的二进制形式为：10100，按照 IEEE754 规格化处理后为 1.0100，尾数补全为 01000000000000000000000
*   20 的阶码真值为 2 4 2^4 24, 依照小阶对大阶的原则，并将 20 的尾数右移 22 位后为 0.000000000000000000000101
*   尾数舍入处理后为 0.00000000000000000000011 与尾数 1.11010110111100110100011 相加
*   20 与 123456789 尾数相加结果为 11010110111100110100100，阶码真值为 2 26 2^{26} 226
*   按照该结果表示相加后的单精度浮点数，则结果为 0 10011001 1.11010110111100110100110
*   将该计算结果化为真值即 111010110111100110100110000B=123456816

![](https://img-blog.csdnimg.cn/8f4e6c8ea58843ddaab1339bbbd8847a.png)

**问题 2：解释为何整数 123456789 转换为单精度浮点数后，变为 123456792.0**

*   由上一问分析可知，123456789 存储为浮点数后，尾数经过规格化与舍入处理后变为：11010110111100110100011
*   尾数补全整数位后为 1.11010110111100110100011，阶码 2 26 2^{26} 226
*   还原为真值为：111010110111100110100011000B=123456792

**问题 3：解释为何浮点数 0.11+0.22 不等于 0.33**

*   本题简要分析同样是因为存在精度丢失问题
*   ![](https://img-blog.csdnimg.cn/c7f4898967134ca39164088c5942d209.png)

![](https://img-blog.csdnimg.cn/f3d546ab1f64419ebe611dead228c8ec.png)

![](https://img-blog.csdnimg.cn/202db01b18d74b3391f4230404af0cb9.png)  
三个浮点数尾数规格化后的精度明显超出了 2 − 23 2^{-23} 2−23，作为单精度浮点数存储和运算时造成的精度丢失导致了运算结果的不相等